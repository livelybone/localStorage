<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>LocalStorage</title>
  <script src="https://unpkg.com/babel-polyfill/dist/polyfill.min.js"></script>
  <script src="../lib/umd/index.js"></script>
</head>
<body>
<div>key is: <span id="key"></span></div>
<button onclick="setKey()">set storage as local-storage</button>
<button onclick="delKey()">del storage</button>

<script>
var storage = new Storage.Storage(true)
var handler = storage.addHandler(handleStorage)

getKey()

function handleStorage(e) {
  var key = e.key
  var newV = e.newValue
  if (key === 'key1') {
    if (!newV) {
      delKey()
    } else {
      setKey(newV)
    }
  }
}

function getKey() {
  document.getElementById('key').innerText = storage.get('key1')
}

function setKey(val) {
  storage.set('key1', val || 'local-storage')
  getKey()
}

function delKey() {
  storage.delete('key1')
  getKey()
}
</script>
</body>
</html>